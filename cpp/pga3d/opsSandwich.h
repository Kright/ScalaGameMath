// Copyright (c) 2025 Igor Slobodskov
// SPDX-License-Identifier: MIT

#pragma once

#include "types.h"

// generated by com.github.kright.pga3d.codegen.cpp.ops.SandwichOpGenerator

namespace pga3d {
    constexpr Multivector Multivector::sandwich(const Multivector& b) const noexcept { return {
        .s = (2.0 * (b.x * (s * x + xyz * yz - xy * y - xz * z) + b.y * (s * y + x * xy - xyz * xz - yz * z) + b.z * (s * z + x * xz + xy * xyz + y * yz)) + b.s * (s * s + x * x + xy * xy + xyz * xyz + xz * xz + y * y + yz * yz + z * z)),
        .w = (2.0 * (b.i * (s * xyz + xz * y - x * yz - xy * z) + b.s * (i * xyz + s * w + wx * x + wxy * xy + wxz * xz + wy * y + wyz * yz + wz * z) + b.x * (i * yz + s * wx + w * x + wyz * xyz - wxy * y - wxz * z - wy * xy - wz * xz) + b.y * (s * wy + w * y + wx * xy + wxy * x - i * xz - wxz * xyz - wyz * z - wz * yz) + b.z * (i * xy + s * wz + w * z + wx * xz + wxy * xyz + wxz * x + wy * yz + wyz * y)) + b.w * (s * s + xy * xy + xz * xz + yz * yz - x * x - xyz * xyz - y * y - z * z)),
        .x = (2.0 * (b.s * (s * x + xy * y + xyz * yz + xz * z) + b.y * (s * xy + x * y - xyz * z - xz * yz) + b.z * (s * xz + x * z + xy * yz + xyz * y)) + b.x * (s * s + x * x + xyz * xyz + yz * yz - xy * xy - xz * xz - y * y - z * z)),
        .y = (2.0 * (b.s * (s * y + yz * z - x * xy - xyz * xz) + b.x * (x * y + xyz * z - s * xy - xz * yz) + b.z * (s * yz + y * z - x * xyz - xy * xz)) + b.y * (s * s + xyz * xyz + xz * xz + y * y - x * x - xy * xy - yz * yz - z * z)),
        .z = (2.0 * (b.s * (s * z + xy * xyz - x * xz - y * yz) + b.x * (x * z + xy * yz - s * xz - xyz * y) + b.y * (x * xyz + y * z - s * yz - xy * xz)) + b.z * (s * s + xy * xy + xyz * xyz + z * z - x * x - xz * xz - y * y - yz * yz)),
        .wx = (2.0 * (s * (b.wxy * y + b.wxz * z + b.wy * xy + b.wz * xz - b.xy * wy - b.xyz * wyz - b.xz * wz - b.yz * i) + x * (-b.wxy * xy - b.wxz * xz - b.wy * y - b.wyz * yz - b.wz * z - b.xy * wxy - b.xyz * i - b.xz * wxz - b.yz * wyz) + xy * (b.xy * wx + b.xyz * wxz + b.xz * i - b.yz * wz) + xyz * (b.wxy * xz + b.wy * z + b.wyz * s + b.xy * wxz + b.xyz * wx + b.yz * w - b.wxz * xy - b.wz * y - b.xz * wxy) + xz * (b.xz * wx + b.yz * wy - b.wyz * y - b.xy * i - b.xyz * wxy) + y * (b.xy * w + b.xyz * wz + b.xz * wyz - b.yz * wxz) + yz * (b.wxz * y + b.wz * xy + b.xy * wz + b.xyz * w + b.yz * wx - b.wxy * z - b.wy * xz - b.xz * wy) + z * (b.wyz * xy + b.xz * w + b.yz * wxy - b.xy * wyz - b.xyz * wy)) + b.wx * (s * s + y * y + yz * yz + z * z - x * x - xy * xy - xyz * xyz - xz * xz)),
        .wy = (2.0 * (s * (b.wyz * z + b.wz * yz + b.xy * wx + b.xyz * wxz + b.xz * i - b.wx * xy - b.wxy * x - b.wxz * xyz - b.yz * wz) + x * (b.yz * wxz - b.wxz * yz - b.xy * w - b.xyz * wz - b.xz * wyz) + xy * (b.xy * wy + b.xyz * wyz + b.xz * wz + b.yz * i - b.wxz * z) + xyz * (b.wxy * yz + b.wz * x + b.xy * wyz + b.xyz * wy - b.wx * z - b.wyz * xy - b.xz * w - b.yz * wxy) + xz * (b.wxy * z + b.wyz * x + b.xz * wy - b.wx * yz - b.wz * xy - b.xy * wz - b.xyz * w - b.yz * wx) + y * (-b.wx * x - b.wxy * xy - b.wxz * xz - b.wyz * yz - b.wz * z - b.xy * wxy - b.xyz * i - b.xz * wxz - b.yz * wyz) + yz * (b.xz * wx + b.yz * wy - b.xy * i - b.xyz * wxy) + z * (b.xy * wxz + b.xyz * wx + b.yz * w - b.xz * wxy)) + b.wy * (s * s + x * x + xz * xz + z * z - xy * xy - xyz * xyz - y * y - yz * yz)),
        .wz = (2.0 * (s * (b.wxy * xyz + b.xz * wx + b.yz * wy - b.wx * xz - b.wxz * x - b.wy * yz - b.wyz * y - b.xy * i - b.xyz * wxy) + x * (b.xy * wyz + b.xyz * wy - b.xz * w - b.yz * wxy) + xy * (b.wx * yz + b.wxz * y + b.xy * wz + b.xyz * w + b.yz * wx - b.wy * xz - b.wyz * x - b.xz * wy) + xyz * (b.wx * y + b.wxz * yz + b.xy * w + b.xyz * wz + b.xz * wyz - b.wy * x - b.wyz * xz - b.yz * wxz) + xz * (b.xy * wy + b.xyz * wyz + b.xz * wz + b.yz * i - b.wxy * y) + y * (b.xz * wxy - b.xy * wxz - b.xyz * wx - b.yz * w) + yz * (b.wxy * x + b.yz * wz - b.xy * wx - b.xyz * wxz - b.xz * i) + z * (-b.wx * x - b.wxy * xy - b.wxz * xz - b.wy * y - b.wyz * yz - b.xy * wxy - b.xyz * i - b.xz * wxz - b.yz * wyz)) + b.wz * (s * s + x * x + xy * xy + y * y - xyz * xyz - xz * xz - yz * yz - z * z)),
        .xy = (2.0 * (b.xyz * (s * z + xy * xyz - x * xz - y * yz) + b.xz * (s * yz + xy * xz - x * xyz - y * z) + b.yz * (x * z + xy * yz - s * xz - xyz * y)) + b.xy * (s * s + xy * xy + xyz * xyz + z * z - x * x - xz * xz - y * y - yz * yz)),
        .xz = (2.0 * (b.xy * (x * xyz + xy * xz - s * yz - y * z) + b.xyz * (x * xy + xyz * xz - s * y - yz * z) + b.yz * (s * xy + xz * yz - x * y - xyz * z)) + b.xz * (s * s + xyz * xyz + xz * xz + y * y - x * x - xy * xy - yz * yz - z * z)),
        .yz = (2.0 * (b.xy * (s * xz + x * z + xy * yz + xyz * y) + b.xyz * (s * x + xy * y + xyz * yz + xz * z) + b.xz * (xyz * z + xz * yz - s * xy - x * y)) + b.yz * (s * s + x * x + xyz * xyz + yz * yz - xy * xy - xz * xz - y * y - z * z)),
        .wxy = (2.0 * (s * (b.wx * y + b.wxz * yz + b.xy * w + b.xyz * wz + b.xz * wyz - b.wy * x - b.wyz * xz - b.wz * xyz - b.yz * wxz) + x * (b.yz * wz - b.wz * yz - b.xy * wx - b.xyz * wxz - b.xz * i) + xy * (b.wx * x + b.wxz * xz + b.wy * y + b.wyz * yz + b.xy * wxy + b.xyz * i + b.xz * wxz + b.yz * wyz) + xyz * (b.wx * xz + b.wxz * x + b.wy * yz + b.wyz * y + b.xy * i + b.xyz * wxy - b.xz * wx - b.yz * wy) + xz * (b.wz * y + b.xz * wxy - b.xy * wxz - b.xyz * wx - b.yz * w) + y * (-b.xy * wy - b.xyz * wyz - b.xz * wz - b.yz * i) + yz * (b.xz * w + b.yz * wxy - b.xy * wyz - b.xyz * wy) + z * (b.wx * yz + b.wxz * y + b.wz * xy + b.xy * wz + b.xyz * w + b.yz * wx - b.wy * xz - b.wyz * x - b.xz * wy)) + b.wxy * (s * s + x * x + xy * xy + y * y - xyz * xyz - xz * xz - yz * yz - z * z)),
        .wxz = (2.0 * (s * (b.wy * xyz + b.xz * w + b.yz * wxy - b.xy * wyz - b.xyz * wy) + x * (b.wx * xz + b.wyz * y + b.xy * i + b.xyz * wxy - b.wxy * xyz - b.wz * s - b.xz * wx - b.yz * wy) + xy * (b.wxy * xz + b.wy * z + b.wyz * s + b.xy * wxz + b.xyz * wx + b.yz * w - b.wx * xyz - b.wz * y - b.xz * wxy) + xyz * (b.xy * wx + b.xyz * wxz + b.xz * i - b.yz * wz) + xz * (b.xy * wxy + b.xyz * i + b.xz * wxz + b.yz * wyz) + y * (b.wy * xz + b.xz * wy - b.xy * wz - b.xyz * w - b.yz * wx) + yz * (b.wy * x + b.wyz * xz + b.wz * xyz + b.yz * wxz - b.wx * y - b.wxy * s - b.xy * w - b.xyz * wz - b.xz * wyz) + z * (b.wx * s + b.wxy * y + b.wyz * xyz + b.wz * xz - b.xy * wy - b.xyz * wyz - b.xz * wz - b.yz * i)) + b.wxz * (s * s + x * x + xz * xz + z * z - xy * xy - xyz * xyz - y * y - yz * yz)),
        .wyz = (2.0 * (s * (b.wxy * xz + b.wy * z + b.xy * wxz + b.xyz * wx + b.yz * w - b.wx * xyz - b.wxz * xy - b.wz * y - b.xz * wxy) + x * (b.wx * yz + b.wxz * y + b.wz * xy + b.xy * wz + b.xyz * w + b.yz * wx - b.wxy * z - b.wy * xz - b.xz * wy) + xy * (b.xy * wyz + b.xyz * wy - b.wx * z - b.xz * w - b.yz * wxy) + xyz * (b.xy * wy + b.xyz * wyz + b.xz * wz + b.yz * i - b.wxy * y - b.wxz * z - b.wy * xy - b.wz * xz) + xz * (b.xy * w + b.xyz * wz + b.xz * wyz - b.yz * wxz) + y * (b.wx * xz + b.xy * i + b.xyz * wxy - b.xz * wx - b.yz * wy) + yz * (b.wxy * xy + b.wxz * xz + b.wy * y + b.wz * z + b.xy * wxy + b.xyz * i + b.xz * wxz + b.yz * wyz) + z * (b.xy * wx + b.xyz * wxz + b.xz * i - b.yz * wz)) + b.wyz * (s * s + y * y + yz * yz + z * z - x * x - xy * xy - xyz * xyz - xz * xz)),
        .xyz = (2.0 * (b.xy * (s * z + x * xz + xy * xyz + y * yz) + b.xz * (xyz * xz + yz * z - s * y - x * xy) + b.yz * (s * x + xyz * yz - xy * y - xz * z)) + b.xyz * (s * s + x * x + xy * xy + xyz * xyz + xz * xz + y * y + yz * yz + z * z)),
        .i = (2.0 * (b.s * (i * s + wxy * z + wy * xz + wyz * x - w * xyz - wx * yz - wxz * y - wz * xy) + b.w * (x * yz + xy * z - s * xyz - xz * y) + b.x * (i * x + s * wyz + wxz * xy + wz * y - w * yz - wx * xyz - wxy * xz - wy * z) + b.y * (i * y + w * xz + wx * z + wyz * xy - s * wxz - wxy * yz - wy * xyz - wz * x) + b.z * (i * z + s * wxy + wy * x + wyz * xz - w * xy - wx * y - wxz * yz - wz * xyz)) + b.i * (s * s + xy * xy + xz * xz + yz * yz - x * x - xyz * xyz - y * y - z * z))
    }; }


    constexpr Motor Motor::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (s * (-b.xy * wy - b.xz * wz - b.yz * i) + xy * (b.wy * s + b.wz * yz + b.xy * wx + b.xz * i - b.yz * wz) + xz * (b.wz * s + b.xz * wx + b.yz * wy - b.wy * yz - b.xy * i) + yz * (b.xy * wz + b.yz * wx - b.xz * wy)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (s * (b.wz * yz + b.xy * wx + b.xz * i - b.wx * xy - b.yz * wz) + xy * (b.xy * wy + b.xz * wz + b.yz * i) + xz * (b.xz * wy - b.wx * yz - b.wz * xy - b.xy * wz - b.yz * wx) + yz * (b.xz * wx + b.yz * wy - b.xy * i)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (s * (b.xz * wx + b.yz * wy - b.wx * xz - b.wy * yz - b.xy * i) + xy * (b.wx * yz + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy) + xz * (b.xy * wy + b.xz * wz + b.yz * i) + yz * (b.yz * wz - b.xy * wx - b.xz * i)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz)),
        .i = (b.i * (s * s + xy * xy + xz * xz + yz * yz) + 2.0 * b.s * (i * s + wy * xz - wx * yz - wz * xy))
    }; }

    constexpr Plane Motor::sandwich(const Plane& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = (2.0 * (b.x * (i * yz + s * wx - wy * xy - wz * xz) + b.y * (s * wy + wx * xy - i * xz - wz * yz) + b.z * (i * xy + s * wz + wx * xz + wy * yz)) + b.w * (s * s + xy * xy + xz * xz + yz * yz))
    }; }

    constexpr Bivector Motor::sandwich(const Bivector& b) const noexcept { return {
        .wx = (2.0 * (s * (-b.xy * wy - b.xz * wz - b.yz * i) + xy * (b.wy * s + b.wz * yz + b.xy * wx + b.xz * i - b.yz * wz) + xz * (b.wz * s + b.xz * wx + b.yz * wy - b.wy * yz - b.xy * i) + yz * (b.xy * wz + b.yz * wx - b.xz * wy)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (s * (b.wz * yz + b.xy * wx + b.xz * i - b.wx * xy - b.yz * wz) + xy * (b.xy * wy + b.xz * wz + b.yz * i) + xz * (b.xz * wy - b.wx * yz - b.wz * xy - b.xy * wz - b.yz * wx) + yz * (b.xz * wx + b.yz * wy - b.xy * i)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (s * (b.xz * wx + b.yz * wy - b.wx * xz - b.wy * yz - b.xy * i) + xy * (b.wx * yz + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy) + xz * (b.xy * wy + b.xz * wz + b.yz * i) + yz * (b.yz * wz - b.xy * wx - b.xz * i)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz))
    }; }

    constexpr ProjectivePoint Motor::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (2.0 * (b.w * (-i * yz - s * wx - wy * xy - wz * xz) + b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.w * (i * xz + wx * xy - s * wy - wz * yz) + b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.w * (wx * xz + wy * yz - i * xy - s * wz) + b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = b.w * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Motor Motor::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .wx = 2.0 * (b.xy * (wx * xy + wz * yz - i * xz - s * wy) + b.xz * (i * xy + wx * xz - s * wz - wy * yz) + b.yz * (wx * yz + wy * xz - i * s - wz * xy)),
        .wy = 2.0 * (b.xy * (s * wx + wy * xy - i * yz - wz * xz) + b.xz * (i * s + wx * yz + wy * xz + wz * xy) + b.yz * (i * xy + wy * yz - s * wz - wx * xz)),
        .wz = 2.0 * (b.xy * (wy * xz + wz * xy - i * s - wx * yz) + b.xz * (s * wx + wz * xz - i * yz - wy * xy) + b.yz * (i * xz + s * wy + wx * xy + wz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz)),
        .i = 2.0 * b.s * (i * s + wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Motor Motor::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = 0.0,
        .xz = 0.0,
        .yz = 0.0,
        .i = 2.0 * b.s * (i * s + wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Motor Motor::sandwich(const Translator& b) const noexcept { return {
        .s = (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = 0.0,
        .xz = 0.0,
        .yz = 0.0,
        .i = 2.0 * (i * s + wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Vector Motor::sandwich(const Vector& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr ProjectivePoint Motor::sandwich(const Point& b) const noexcept { return {
        .x = (2.0 * (s * (-wx + b.y * xy + b.z * xz) + yz * (-i + b.z * xy - b.y * xz) - wy * xy - wz * xz) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (s * (-wy + b.z * yz - b.x * xy) + wx * xy + xz * (i - b.x * yz - b.z * xy) - wz * yz) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (s * (-wz - b.x * xz - b.y * yz) + wx * xz + wy * yz + xy * (-i + b.x * yz - b.y * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Plane Motor::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = 2.0 * (b.x * (i * yz + s * wx - wy * xy - wz * xz) + b.y * (s * wy + wx * xy - i * xz - wz * yz) + b.z * (i * xy + s * wz + wx * xz + wy * yz))
    }; }

    constexpr Bivector Motor::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * (b.xy * (wx * xy + wz * yz - i * xz - s * wy) + b.xz * (i * xy + wx * xz - s * wz - wy * yz) + b.yz * (wx * yz + wy * xz - i * s - wz * xy)),
        .wy = 2.0 * (b.xy * (s * wx + wy * xy - i * yz - wz * xz) + b.xz * (i * s + wx * yz + wy * xz + wz * xy) + b.yz * (i * xy + wy * yz - s * wz - wx * xz)),
        .wz = 2.0 * (b.xy * (wy * xz + wz * xy - i * s - wx * yz) + b.xz * (s * wx + wz * xz - i * yz - wy * xy) + b.yz * (i * xz + s * wy + wx * xy + wz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz))
    }; }

    constexpr BivectorWeight Motor::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr PseudoScalar Motor::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr ProjectivePoint Motor::sandwich(const PointCenter& b) const noexcept { return {
        .x = 2.0 * (-i * yz - s * wx - wy * xy - wz * xz),
        .y = 2.0 * (i * xz + wx * xy - s * wy - wz * yz),
        .z = 2.0 * (wx * xz + wy * yz - i * xy - s * wz),
        .w = (s * s + xy * xy + xz * xz + yz * yz)
    }; }


    constexpr Motor Plane::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .wx = (2.0 * (w * (b.xy * y + b.xz * z) + x * (-b.wy * y - b.wz * z)) + b.wx * (y * y + z * z - x * x)),
        .wy = (2.0 * (x * (-b.wx * y - b.xy * w) + z * (b.yz * w - b.wz * y)) + b.wy * (x * x + z * z - y * y)),
        .wz = (2.0 * (x * (-b.wx * z - b.xz * w) + y * (-b.wy * z - b.yz * w)) + b.wz * (x * x + y * y - z * z)),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y)),
        .i = b.i * (-x * x - y * y - z * z)
    }; }

    constexpr Plane Plane::sandwich(const Plane& b) const noexcept { return {
        .x = (b.x * (x * x - y * y - z * z) + 2.0 * x * (b.y * y + b.z * z)),
        .y = (b.y * (y * y - x * x - z * z) + 2.0 * y * (b.x * x + b.z * z)),
        .z = (b.z * (z * z - x * x - y * y) + 2.0 * z * (b.x * x + b.y * y)),
        .w = (b.w * (-x * x - y * y - z * z) + 2.0 * w * (b.x * x + b.y * y + b.z * z))
    }; }

    constexpr Bivector Plane::sandwich(const Bivector& b) const noexcept { return {
        .wx = (2.0 * (w * (b.xy * y + b.xz * z) + x * (-b.wy * y - b.wz * z)) + b.wx * (y * y + z * z - x * x)),
        .wy = (2.0 * (x * (-b.wx * y - b.xy * w) + z * (b.yz * w - b.wz * y)) + b.wy * (x * x + z * z - y * y)),
        .wz = (2.0 * (x * (-b.wx * z - b.xz * w) + y * (-b.wy * z - b.yz * w)) + b.wz * (x * x + y * y - z * z)),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y))
    }; }

    constexpr ProjectivePoint Plane::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (b.x * (y * y + z * z) + x * (2.0 * (-b.w * w - b.y * y - b.z * z) - b.x * x)),
        .y = (b.y * (x * x + z * z) + y * (2.0 * (-b.w * w - b.x * x - b.z * z) - b.y * y)),
        .z = (b.z * (x * x + y * y) + z * (2.0 * (-b.w * w - b.x * x - b.y * y) - b.z * z)),
        .w = b.w * (x * x + y * y + z * z)
    }; }

    constexpr Motor Plane::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .wx = 2.0 * w * (b.xy * y + b.xz * z),
        .wy = 2.0 * w * (b.yz * z - b.xy * x),
        .wz = 2.0 * w * (-b.xz * x - b.yz * y),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y)),
        .i = 0.0
    }; }

    constexpr ProjectiveTranslator Plane::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr ProjectiveTranslator Plane::sandwich(const Translator& b) const noexcept { return {
        .s = (x * x + y * y + z * z),
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr Vector Plane::sandwich(const Vector& b) const noexcept { return {
        .x = (b.x * (y * y + z * z - x * x) + 2.0 * x * (-b.y * y - b.z * z)),
        .y = (b.y * (x * x + z * z - y * y) + 2.0 * y * (-b.x * x - b.z * z)),
        .z = (b.z * (x * x + y * y - z * z) + 2.0 * z * (-b.x * x - b.y * y))
    }; }

    constexpr ProjectivePoint Plane::sandwich(const Point& b) const noexcept { return {
        .x = (b.x * (y * y + z * z) + x * (2.0 * (-w - b.y * y - b.z * z) - b.x * x)),
        .y = (b.y * (x * x + z * z) + y * (2.0 * (-w - b.x * x - b.z * z) - b.y * y)),
        .z = (b.z * (x * x + y * y) + z * (2.0 * (-w - b.x * x - b.y * y) - b.z * z)),
        .w = (x * x + y * y + z * z)
    }; }

    constexpr Plane Plane::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (b.x * (x * x - y * y - z * z) + 2.0 * x * (b.y * y + b.z * z)),
        .y = (b.y * (y * y - x * x - z * z) + 2.0 * y * (b.x * x + b.z * z)),
        .z = (b.z * (z * z - x * x - y * y) + 2.0 * z * (b.x * x + b.y * y)),
        .w = 2.0 * w * (b.x * x + b.y * y + b.z * z)
    }; }

    constexpr Bivector Plane::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * w * (b.xy * y + b.xz * z),
        .wy = 2.0 * w * (b.yz * z - b.xy * x),
        .wz = 2.0 * w * (-b.xz * x - b.yz * y),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y))
    }; }

    constexpr BivectorWeight Plane::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr PseudoScalar Plane::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (-x * x - y * y - z * z)
    }; }

    constexpr ProjectivePoint Plane::sandwich(const PointCenter& b) const noexcept { return {
        .x = -2.0 * w * x,
        .y = -2.0 * w * y,
        .z = -2.0 * w * z,
        .w = (x * x + y * y + z * z)
    }; }


    constexpr Motor Bivector::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.yz * (wy * xz - wz * xy) + wx * (b.xy * xy + b.xz * xz) + yz * (b.wz * xy + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy)) + b.wx * (yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.xz * (wx * yz + wz * xy) + wy * (b.xy * xy + b.yz * yz) + xz * (b.xz * wy - b.wx * yz - b.wz * xy - b.xy * wz - b.yz * wx)) + b.wy * (xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.xy * (wy * xz - wx * yz) + wz * (b.xz * xz + b.yz * yz) + xy * (b.wx * yz + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy)) + b.wz * (xy * xy - xz * xz - yz * yz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz)),
        .i = (b.i * (xy * xy + xz * xz + yz * yz) + 2.0 * b.s * (wy * xz - wx * yz - wz * xy))
    }; }

    constexpr Plane Bivector::sandwich(const Plane& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz)),
        .w = (2.0 * (b.x * (-wy * xy - wz * xz) + b.y * (wx * xy - wz * yz) + b.z * (wx * xz + wy * yz)) + b.w * (xy * xy + xz * xz + yz * yz))
    }; }

    constexpr Bivector Bivector::sandwich(const Bivector& b) const noexcept { return {
        .wx = (2.0 * (b.yz * (wy * xz - wz * xy) + wx * (b.xy * xy + b.xz * xz) + yz * (b.wz * xy + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy)) + b.wx * (yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.xz * (wx * yz + wz * xy) + wy * (b.xy * xy + b.yz * yz) + xz * (b.xz * wy - b.wx * yz - b.wz * xy - b.xy * wz - b.yz * wx)) + b.wy * (xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.xy * (wy * xz - wx * yz) + wz * (b.xz * xz + b.yz * yz) + xy * (b.wx * yz + b.xy * wz + b.yz * wx - b.wy * xz - b.xz * wy)) + b.wz * (xy * xy - xz * xz - yz * yz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz))
    }; }

    constexpr ProjectivePoint Bivector::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (2.0 * (b.w * (-wy * xy - wz * xz) + yz * (b.z * xy - b.y * xz)) + b.x * (yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.w * (wx * xy - wz * yz) + xz * (-b.x * yz - b.z * xy)) + b.y * (xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.w * (wx * xz + wy * yz) + xy * (b.x * yz - b.y * xz)) + b.z * (xy * xy - xz * xz - yz * yz)),
        .w = b.w * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Motor Bivector::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .wx = 2.0 * (b.yz * (wy * xz - wz * xy) + wx * (b.xy * xy + b.xz * xz) + yz * (b.xy * wz + b.yz * wx - b.xz * wy)),
        .wy = 2.0 * (b.xz * (wx * yz + wz * xy) + wy * (b.xy * xy + b.yz * yz) + xz * (b.xz * wy - b.xy * wz - b.yz * wx)),
        .wz = 2.0 * (b.xy * (wy * xz + wz * xy - wx * yz) + b.xz * (wz * xz - wy * xy) + b.yz * (wx * xy + wz * yz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz)),
        .i = 2.0 * b.s * (wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Motor Bivector::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz)),
        .xy = 0.0,
        .xz = 0.0,
        .yz = 0.0,
        .i = 2.0 * b.s * (wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Motor Bivector::sandwich(const Translator& b) const noexcept { return {
        .s = (xy * xy + xz * xz + yz * yz),
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz)),
        .xy = 0.0,
        .xz = 0.0,
        .yz = 0.0,
        .i = 2.0 * (wy * xz - wx * yz - wz * xy)
    }; }

    constexpr Vector Bivector::sandwich(const Vector& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz))
    }; }

    constexpr ProjectivePoint Bivector::sandwich(const Point& b) const noexcept { return {
        .x = (2.0 * (xy * (-wy + b.z * yz) + xz * (-wz - b.y * yz)) + b.x * (yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (xy * (wx - b.z * xz) + yz * (-wz - b.x * xz)) + b.y * (xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (xz * (wx - b.y * xy) + yz * (wy + b.x * xy)) + b.z * (xy * xy - xz * xz - yz * yz)),
        .w = (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Plane Bivector::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz)),
        .w = 2.0 * (b.x * (-wy * xy - wz * xz) + b.y * (wx * xy - wz * yz) + b.z * (wx * xz + wy * yz))
    }; }

    constexpr Bivector Bivector::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * (b.yz * (wy * xz - wz * xy) + wx * (b.xy * xy + b.xz * xz) + yz * (b.xy * wz + b.yz * wx - b.xz * wy)),
        .wy = 2.0 * (b.xz * (wx * yz + wz * xy) + wy * (b.xy * xy + b.yz * yz) + xz * (b.xz * wy - b.xy * wz - b.yz * wx)),
        .wz = 2.0 * (b.xy * (wy * xz + wz * xy - wx * yz) + b.xz * (wz * xz - wy * xy) + b.yz * (wx * xy + wz * yz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz))
    }; }

    constexpr BivectorWeight Bivector::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz))
    }; }

    constexpr PseudoScalar Bivector::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr ProjectivePoint Bivector::sandwich(const PointCenter& b) const noexcept { return {
        .x = 2.0 * (-wy * xy - wz * xz),
        .y = 2.0 * (wx * xy - wz * yz),
        .z = 2.0 * (wx * xz + wy * yz),
        .w = (xy * xy + xz * xz + yz * yz)
    }; }


    constexpr Motor ProjectivePoint::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * w * w,
        .wx = w * (2.0 * (b.xy * y + b.xz * z) - b.wx * w),
        .wy = w * (2.0 * (b.yz * z - b.xy * x) - b.wy * w),
        .wz = w * (2.0 * (-b.xz * x - b.yz * y) - b.wz * w),
        .xy = b.xy * w * w,
        .xz = b.xz * w * w,
        .yz = b.yz * w * w,
        .i = -b.i * w * w
    }; }

    constexpr Plane ProjectivePoint::sandwich(const Plane& b) const noexcept { return {
        .x = b.x * w * w,
        .y = b.y * w * w,
        .z = b.z * w * w,
        .w = w * (2.0 * (-b.x * x - b.y * y - b.z * z) - b.w * w)
    }; }

    constexpr Bivector ProjectivePoint::sandwich(const Bivector& b) const noexcept { return {
        .wx = w * (2.0 * (b.xy * y + b.xz * z) - b.wx * w),
        .wy = w * (2.0 * (b.yz * z - b.xy * x) - b.wy * w),
        .wz = w * (2.0 * (-b.xz * x - b.yz * y) - b.wz * w),
        .xy = b.xy * w * w,
        .xz = b.xz * w * w,
        .yz = b.yz * w * w
    }; }

    constexpr ProjectivePoint ProjectivePoint::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = w * (-b.x * w + 2.0 * b.w * x),
        .y = w * (-b.y * w + 2.0 * b.w * y),
        .z = w * (-b.z * w + 2.0 * b.w * z),
        .w = b.w * w * w
    }; }

    constexpr Motor ProjectivePoint::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * w * w,
        .wx = 2.0 * w * (b.xy * y + b.xz * z),
        .wy = 2.0 * w * (b.yz * z - b.xy * x),
        .wz = 2.0 * w * (-b.xz * x - b.yz * y),
        .xy = b.xy * w * w,
        .xz = b.xz * w * w,
        .yz = b.yz * w * w,
        .i = 0.0
    }; }

    constexpr ProjectiveTranslator ProjectivePoint::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * w * w,
        .wx = -b.wx * w * w,
        .wy = -b.wy * w * w,
        .wz = -b.wz * w * w
    }; }

    constexpr ProjectiveTranslator ProjectivePoint::sandwich(const Translator& b) const noexcept { return {
        .s = w * w,
        .wx = -b.wx * w * w,
        .wy = -b.wy * w * w,
        .wz = -b.wz * w * w
    }; }

    constexpr Vector ProjectivePoint::sandwich(const Vector& b) const noexcept { return {
        .x = -b.x * w * w,
        .y = -b.y * w * w,
        .z = -b.z * w * w
    }; }

    constexpr ProjectivePoint ProjectivePoint::sandwich(const Point& b) const noexcept { return {
        .x = w * (2.0 * x - b.x * w),
        .y = w * (2.0 * y - b.y * w),
        .z = w * (2.0 * z - b.z * w),
        .w = w * w
    }; }

    constexpr Plane ProjectivePoint::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = b.x * w * w,
        .y = b.y * w * w,
        .z = b.z * w * w,
        .w = 2.0 * w * (-b.x * x - b.y * y - b.z * z)
    }; }

    constexpr Bivector ProjectivePoint::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * w * (b.xy * y + b.xz * z),
        .wy = 2.0 * w * (b.yz * z - b.xy * x),
        .wz = 2.0 * w * (-b.xz * x - b.yz * y),
        .xy = b.xy * w * w,
        .xz = b.xz * w * w,
        .yz = b.yz * w * w
    }; }

    constexpr BivectorWeight ProjectivePoint::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = -b.wx * w * w,
        .wy = -b.wy * w * w,
        .wz = -b.wz * w * w
    }; }

    constexpr PseudoScalar ProjectivePoint::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = -b.i * w * w
    }; }

    constexpr ProjectivePoint ProjectivePoint::sandwich(const PointCenter& b) const noexcept { return {
        .x = 2.0 * w * x,
        .y = 2.0 * w * y,
        .z = 2.0 * w * z,
        .w = w * w
    }; }


    constexpr Motor Quaternion::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz)),
        .i = b.i * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Plane Quaternion::sandwich(const Plane& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = b.w * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Bivector Quaternion::sandwich(const Bivector& b) const noexcept { return {
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz)),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz))
    }; }

    constexpr ProjectivePoint Quaternion::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = b.w * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Quaternion Quaternion::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz))
    }; }

    constexpr ProjectiveTranslator Quaternion::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr ProjectiveTranslator Quaternion::sandwich(const Translator& b) const noexcept { return {
        .s = (s * s + xy * xy + xz * xz + yz * yz),
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr Vector Quaternion::sandwich(const Vector& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr ProjectivePoint Quaternion::sandwich(const Point& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz)),
        .w = (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr PlaneIdeal Quaternion::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (2.0 * (b.y * (s * xy - xz * yz) + b.z * (s * xz + xy * yz)) + b.x * (s * s + yz * yz - xy * xy - xz * xz)),
        .y = (2.0 * (b.x * (-s * xy - xz * yz) + b.z * (s * yz - xy * xz)) + b.y * (s * s + xz * xz - xy * xy - yz * yz)),
        .z = (2.0 * (b.x * (xy * yz - s * xz) + b.y * (-s * yz - xy * xz)) + b.z * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr BivectorBulk Quaternion::sandwich(const BivectorBulk& b) const noexcept { return {
        .xy = (2.0 * (b.xz * (s * yz + xy * xz) + b.yz * (xy * yz - s * xz)) + b.xy * (s * s + xy * xy - xz * xz - yz * yz)),
        .xz = (2.0 * (b.xy * (xy * xz - s * yz) + b.yz * (s * xy + xz * yz)) + b.xz * (s * s + xz * xz - xy * xy - yz * yz)),
        .yz = (2.0 * (b.xy * (s * xz + xy * yz) + b.xz * (xz * yz - s * xy)) + b.yz * (s * s + yz * yz - xy * xy - xz * xz))
    }; }

    constexpr BivectorWeight Quaternion::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (2.0 * (b.wy * (s * xy - xz * yz) + b.wz * (s * xz + xy * yz)) + b.wx * (s * s + yz * yz - xy * xy - xz * xz)),
        .wy = (2.0 * (b.wx * (-s * xy - xz * yz) + b.wz * (s * yz - xy * xz)) + b.wy * (s * s + xz * xz - xy * xy - yz * yz)),
        .wz = (2.0 * (b.wx * (xy * yz - s * xz) + b.wy * (-s * yz - xy * xz)) + b.wz * (s * s + xy * xy - xz * xz - yz * yz))
    }; }

    constexpr PseudoScalar Quaternion::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (s * s + xy * xy + xz * xz + yz * yz)
    }; }

    constexpr ProjectivePoint Quaternion::sandwich(const PointCenter& b) const noexcept { return {
        .x = 0.0,
        .y = 0.0,
        .z = 0.0,
        .w = (s * s + xy * xy + xz * xz + yz * yz)
    }; }


    constexpr Motor ProjectiveTranslator::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * s * s,
        .wx = s * (2.0 * (-b.xy * wy - b.xz * wz) + b.wx * s),
        .wy = s * (2.0 * (b.xy * wx - b.yz * wz) + b.wy * s),
        .wz = s * (2.0 * (b.xz * wx + b.yz * wy) + b.wz * s),
        .xy = b.xy * s * s,
        .xz = b.xz * s * s,
        .yz = b.yz * s * s,
        .i = b.i * s * s
    }; }

    constexpr Plane ProjectiveTranslator::sandwich(const Plane& b) const noexcept { return {
        .x = b.x * s * s,
        .y = b.y * s * s,
        .z = b.z * s * s,
        .w = s * (2.0 * (b.x * wx + b.y * wy + b.z * wz) + b.w * s)
    }; }

    constexpr Bivector ProjectiveTranslator::sandwich(const Bivector& b) const noexcept { return {
        .wx = s * (2.0 * (-b.xy * wy - b.xz * wz) + b.wx * s),
        .wy = s * (2.0 * (b.xy * wx - b.yz * wz) + b.wy * s),
        .wz = s * (2.0 * (b.xz * wx + b.yz * wy) + b.wz * s),
        .xy = b.xy * s * s,
        .xz = b.xz * s * s,
        .yz = b.yz * s * s
    }; }

    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = s * (b.x * s - 2.0 * b.w * wx),
        .y = s * (b.y * s - 2.0 * b.w * wy),
        .z = s * (b.z * s - 2.0 * b.w * wz),
        .w = b.w * s * s
    }; }

    constexpr Motor ProjectiveTranslator::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * s * s,
        .wx = 2.0 * s * (-b.xy * wy - b.xz * wz),
        .wy = 2.0 * s * (b.xy * wx - b.yz * wz),
        .wz = 2.0 * s * (b.xz * wx + b.yz * wy),
        .xy = b.xy * s * s,
        .xz = b.xz * s * s,
        .yz = b.yz * s * s,
        .i = 0.0
    }; }

    constexpr ProjectiveTranslator ProjectiveTranslator::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * s * s,
        .wx = b.wx * s * s,
        .wy = b.wy * s * s,
        .wz = b.wz * s * s
    }; }

    constexpr ProjectiveTranslator ProjectiveTranslator::sandwich(const Translator& b) const noexcept { return {
        .s = s * s,
        .wx = b.wx * s * s,
        .wy = b.wy * s * s,
        .wz = b.wz * s * s
    }; }

    constexpr Vector ProjectiveTranslator::sandwich(const Vector& b) const noexcept { return {
        .x = b.x * s * s,
        .y = b.y * s * s,
        .z = b.z * s * s
    }; }

    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const Point& b) const noexcept { return {
        .x = s * (b.x * s - 2.0 * wx),
        .y = s * (b.y * s - 2.0 * wy),
        .z = s * (b.z * s - 2.0 * wz),
        .w = s * s
    }; }

    constexpr Plane ProjectiveTranslator::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = b.x * s * s,
        .y = b.y * s * s,
        .z = b.z * s * s,
        .w = 2.0 * s * (b.x * wx + b.y * wy + b.z * wz)
    }; }

    constexpr Bivector ProjectiveTranslator::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * s * (-b.xy * wy - b.xz * wz),
        .wy = 2.0 * s * (b.xy * wx - b.yz * wz),
        .wz = 2.0 * s * (b.xz * wx + b.yz * wy),
        .xy = b.xy * s * s,
        .xz = b.xz * s * s,
        .yz = b.yz * s * s
    }; }

    constexpr BivectorWeight ProjectiveTranslator::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = b.wx * s * s,
        .wy = b.wy * s * s,
        .wz = b.wz * s * s
    }; }

    constexpr PseudoScalar ProjectiveTranslator::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * s * s
    }; }

    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const PointCenter& b) const noexcept { return {
        .x = -2.0 * s * wx,
        .y = -2.0 * s * wy,
        .z = -2.0 * s * wz,
        .w = s * s
    }; }


    constexpr Motor Translator::sandwich(const Motor& b) const noexcept { return {
        .s = b.s,
        .wx = (b.wx - 2.0 * b.xy * wy - 2.0 * b.xz * wz),
        .wy = (b.wy - 2.0 * b.yz * wz + 2.0 * b.xy * wx),
        .wz = (b.wz + 2.0 * b.xz * wx + 2.0 * b.yz * wy),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz,
        .i = b.i
    }; }

    constexpr Plane Translator::sandwich(const Plane& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z,
        .w = (b.w + 2.0 * b.x * wx + 2.0 * b.y * wy + 2.0 * b.z * wz)
    }; }

    constexpr Bivector Translator::sandwich(const Bivector& b) const noexcept { return {
        .wx = (b.wx - 2.0 * b.xy * wy - 2.0 * b.xz * wz),
        .wy = (b.wy - 2.0 * b.yz * wz + 2.0 * b.xy * wx),
        .wz = (b.wz + 2.0 * b.xz * wx + 2.0 * b.yz * wy),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr ProjectivePoint Translator::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (b.x - 2.0 * b.w * wx),
        .y = (b.y - 2.0 * b.w * wy),
        .z = (b.z - 2.0 * b.w * wz),
        .w = b.w
    }; }

    constexpr Motor Translator::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s,
        .wx = 2.0 * (-b.xy * wy - b.xz * wz),
        .wy = 2.0 * (b.xy * wx - b.yz * wz),
        .wz = 2.0 * (b.xz * wx + b.yz * wy),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz,
        .i = 0.0
    }; }

    constexpr ProjectiveTranslator Translator::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s,
        .wx = b.wx,
        .wy = b.wy,
        .wz = b.wz
    }; }

    constexpr Translator Translator::sandwich(const Translator& b) const noexcept { return {
        .wx = b.wx,
        .wy = b.wy,
        .wz = b.wz
    }; }

    constexpr Vector Translator::sandwich(const Vector& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z
    }; }

    constexpr Point Translator::sandwich(const Point& b) const noexcept { return {
        .x = (b.x - 2.0 * wx),
        .y = (b.y - 2.0 * wy),
        .z = (b.z - 2.0 * wz)
    }; }

    constexpr Plane Translator::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z,
        .w = 2.0 * (b.x * wx + b.y * wy + b.z * wz)
    }; }

    constexpr Bivector Translator::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * (-b.xy * wy - b.xz * wz),
        .wy = 2.0 * (b.xy * wx - b.yz * wz),
        .wz = 2.0 * (b.xz * wx + b.yz * wy),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr BivectorWeight Translator::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = b.wx,
        .wy = b.wy,
        .wz = b.wz
    }; }

    constexpr PseudoScalar Translator::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i
    }; }

    constexpr Point Translator::sandwich(const PointCenter& b) const noexcept { return {
        .x = -2.0 * wx,
        .y = -2.0 * wy,
        .z = -2.0 * wz
    }; }



    constexpr Motor Point::sandwich(const Motor& b) const noexcept { return {
        .s = b.s,
        .wx = (-b.wx + 2.0 * (b.xy * y + b.xz * z)),
        .wy = (-b.wy + 2.0 * (b.yz * z - b.xy * x)),
        .wz = (-b.wz + 2.0 * (-b.xz * x - b.yz * y)),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz,
        .i = -b.i
    }; }

    constexpr Plane Point::sandwich(const Plane& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z,
        .w = (-b.w + 2.0 * (-b.x * x - b.y * y - b.z * z))
    }; }

    constexpr Bivector Point::sandwich(const Bivector& b) const noexcept { return {
        .wx = (-b.wx + 2.0 * (b.xy * y + b.xz * z)),
        .wy = (-b.wy + 2.0 * (b.yz * z - b.xy * x)),
        .wz = (-b.wz + 2.0 * (-b.xz * x - b.yz * y)),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr ProjectivePoint Point::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (-b.x + 2.0 * b.w * x),
        .y = (-b.y + 2.0 * b.w * y),
        .z = (-b.z + 2.0 * b.w * z),
        .w = b.w
    }; }

    constexpr Motor Point::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s,
        .wx = 2.0 * (b.xy * y + b.xz * z),
        .wy = 2.0 * (b.yz * z - b.xy * x),
        .wz = 2.0 * (-b.xz * x - b.yz * y),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz,
        .i = 0.0
    }; }

    constexpr ProjectiveTranslator Point::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s,
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr Translator Point::sandwich(const Translator& b) const noexcept { return {
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr Vector Point::sandwich(const Vector& b) const noexcept { return {
        .x = -b.x,
        .y = -b.y,
        .z = -b.z
    }; }

    constexpr Point Point::sandwich(const Point& b) const noexcept { return {
        .x = (-b.x + 2.0 * x),
        .y = (-b.y + 2.0 * y),
        .z = (-b.z + 2.0 * z)
    }; }

    constexpr Plane Point::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z,
        .w = 2.0 * (-b.x * x - b.y * y - b.z * z)
    }; }

    constexpr Bivector Point::sandwich(const BivectorBulk& b) const noexcept { return {
        .wx = 2.0 * (b.xy * y + b.xz * z),
        .wy = 2.0 * (b.yz * z - b.xy * x),
        .wz = 2.0 * (-b.xz * x - b.yz * y),
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr BivectorWeight Point::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr PseudoScalar Point::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = -b.i
    }; }

    constexpr Point Point::sandwich(const PointCenter& b) const noexcept { return {
        .x = 2.0 * x,
        .y = 2.0 * y,
        .z = 2.0 * z
    }; }


    constexpr Motor PlaneIdeal::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y)),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y)),
        .i = b.i * (-x * x - y * y - z * z)
    }; }

    constexpr Plane PlaneIdeal::sandwich(const Plane& b) const noexcept { return {
        .x = (b.x * (x * x - y * y - z * z) + 2.0 * x * (b.y * y + b.z * z)),
        .y = (b.y * (y * y - x * x - z * z) + 2.0 * y * (b.x * x + b.z * z)),
        .z = (b.z * (z * z - x * x - y * y) + 2.0 * z * (b.x * x + b.y * y)),
        .w = b.w * (-x * x - y * y - z * z)
    }; }

    constexpr Bivector PlaneIdeal::sandwich(const Bivector& b) const noexcept { return {
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y)),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y))
    }; }

    constexpr ProjectivePoint PlaneIdeal::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (b.x * (y * y + z * z - x * x) + 2.0 * x * (-b.y * y - b.z * z)),
        .y = (b.y * (x * x + z * z - y * y) + 2.0 * y * (-b.x * x - b.z * z)),
        .z = (b.z * (x * x + y * y - z * z) + 2.0 * z * (-b.x * x - b.y * y)),
        .w = b.w * (x * x + y * y + z * z)
    }; }

    constexpr Quaternion PlaneIdeal::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y))
    }; }

    constexpr ProjectiveTranslator PlaneIdeal::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (x * x + y * y + z * z),
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr ProjectiveTranslator PlaneIdeal::sandwich(const Translator& b) const noexcept { return {
        .s = (x * x + y * y + z * z),
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr Vector PlaneIdeal::sandwich(const Vector& b) const noexcept { return {
        .x = (b.x * (y * y + z * z - x * x) + 2.0 * x * (-b.y * y - b.z * z)),
        .y = (b.y * (x * x + z * z - y * y) + 2.0 * y * (-b.x * x - b.z * z)),
        .z = (b.z * (x * x + y * y - z * z) + 2.0 * z * (-b.x * x - b.y * y))
    }; }

    constexpr ProjectivePoint PlaneIdeal::sandwich(const Point& b) const noexcept { return {
        .x = (b.x * (y * y + z * z - x * x) + 2.0 * x * (-b.y * y - b.z * z)),
        .y = (b.y * (x * x + z * z - y * y) + 2.0 * y * (-b.x * x - b.z * z)),
        .z = (b.z * (x * x + y * y - z * z) + 2.0 * z * (-b.x * x - b.y * y)),
        .w = (x * x + y * y + z * z)
    }; }

    constexpr PlaneIdeal PlaneIdeal::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (b.x * (x * x - y * y - z * z) + 2.0 * x * (b.y * y + b.z * z)),
        .y = (b.y * (y * y - x * x - z * z) + 2.0 * y * (b.x * x + b.z * z)),
        .z = (b.z * (z * z - x * x - y * y) + 2.0 * z * (b.x * x + b.y * y))
    }; }

    constexpr BivectorBulk PlaneIdeal::sandwich(const BivectorBulk& b) const noexcept { return {
        .xy = (b.xy * (z * z - x * x - y * y) + 2.0 * z * (b.yz * x - b.xz * y)),
        .xz = (b.xz * (y * y - x * x - z * z) + 2.0 * y * (-b.xy * z - b.yz * x)),
        .yz = (b.yz * (x * x - y * y - z * z) + 2.0 * x * (b.xy * z - b.xz * y))
    }; }

    constexpr BivectorWeight PlaneIdeal::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (b.wx * (y * y + z * z - x * x) + 2.0 * x * (-b.wy * y - b.wz * z)),
        .wy = (b.wy * (x * x + z * z - y * y) + 2.0 * y * (-b.wx * x - b.wz * z)),
        .wz = (b.wz * (x * x + y * y - z * z) + 2.0 * z * (-b.wx * x - b.wy * y))
    }; }

    constexpr PseudoScalar PlaneIdeal::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (-x * x - y * y - z * z)
    }; }

    constexpr ProjectivePoint PlaneIdeal::sandwich(const PointCenter& b) const noexcept { return {
        .x = 0.0,
        .y = 0.0,
        .z = 0.0,
        .w = (x * x + y * y + z * z)
    }; }


    constexpr Motor BivectorBulk::sandwich(const Motor& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz)),
        .i = b.i * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Plane BivectorBulk::sandwich(const Plane& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz)),
        .w = b.w * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Bivector BivectorBulk::sandwich(const Bivector& b) const noexcept { return {
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz)),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz))
    }; }

    constexpr ProjectivePoint BivectorBulk::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz)),
        .w = b.w * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr Quaternion BivectorBulk::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz))
    }; }

    constexpr ProjectiveTranslator BivectorBulk::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s * (xy * xy + xz * xz + yz * yz),
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz))
    }; }

    constexpr ProjectiveTranslator BivectorBulk::sandwich(const Translator& b) const noexcept { return {
        .s = (xy * xy + xz * xz + yz * yz),
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz))
    }; }

    constexpr Vector BivectorBulk::sandwich(const Vector& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz))
    }; }

    constexpr ProjectivePoint BivectorBulk::sandwich(const Point& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz)),
        .w = (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr PlaneIdeal BivectorBulk::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = (b.x * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.z * xy - b.y * xz)),
        .y = (b.y * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.x * yz - b.z * xy)),
        .z = (b.z * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.x * yz - b.y * xz))
    }; }

    constexpr BivectorBulk BivectorBulk::sandwich(const BivectorBulk& b) const noexcept { return {
        .xy = (b.xy * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.xz * xz + b.yz * yz)),
        .xz = (b.xz * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (b.xy * xy + b.yz * yz)),
        .yz = (b.yz * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.xy * xy + b.xz * xz))
    }; }

    constexpr BivectorWeight BivectorBulk::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = (b.wx * (yz * yz - xy * xy - xz * xz) + 2.0 * yz * (b.wz * xy - b.wy * xz)),
        .wy = (b.wy * (xz * xz - xy * xy - yz * yz) + 2.0 * xz * (-b.wx * yz - b.wz * xy)),
        .wz = (b.wz * (xy * xy - xz * xz - yz * yz) + 2.0 * xy * (b.wx * yz - b.wy * xz))
    }; }

    constexpr PseudoScalar BivectorBulk::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = b.i * (xy * xy + xz * xz + yz * yz)
    }; }

    constexpr ProjectivePoint BivectorBulk::sandwich(const PointCenter& b) const noexcept { return {
        .x = 0.0,
        .y = 0.0,
        .z = 0.0,
        .w = (xy * xy + xz * xz + yz * yz)
    }; }




    constexpr Motor PointCenter::sandwich(const Motor& b) const noexcept { return {
        .s = b.s,
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz,
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz,
        .i = -b.i
    }; }

    constexpr Plane PointCenter::sandwich(const Plane& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z,
        .w = -b.w
    }; }

    constexpr Bivector PointCenter::sandwich(const Bivector& b) const noexcept { return {
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz,
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr ProjectivePoint PointCenter::sandwich(const ProjectivePoint& b) const noexcept { return {
        .x = -b.x,
        .y = -b.y,
        .z = -b.z,
        .w = b.w
    }; }

    constexpr Quaternion PointCenter::sandwich(const Quaternion& b) const noexcept { return {
        .s = b.s,
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr ProjectiveTranslator PointCenter::sandwich(const ProjectiveTranslator& b) const noexcept { return {
        .s = b.s,
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr Translator PointCenter::sandwich(const Translator& b) const noexcept { return {
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr Vector PointCenter::sandwich(const Vector& b) const noexcept { return {
        .x = -b.x,
        .y = -b.y,
        .z = -b.z
    }; }

    constexpr Point PointCenter::sandwich(const Point& b) const noexcept { return {
        .x = -b.x,
        .y = -b.y,
        .z = -b.z
    }; }

    constexpr PlaneIdeal PointCenter::sandwich(const PlaneIdeal& b) const noexcept { return {
        .x = b.x,
        .y = b.y,
        .z = b.z
    }; }

    constexpr BivectorBulk PointCenter::sandwich(const BivectorBulk& b) const noexcept { return {
        .xy = b.xy,
        .xz = b.xz,
        .yz = b.yz
    }; }

    constexpr BivectorWeight PointCenter::sandwich(const BivectorWeight& b) const noexcept { return {
        .wx = -b.wx,
        .wy = -b.wy,
        .wz = -b.wz
    }; }

    constexpr PseudoScalar PointCenter::sandwich(const PseudoScalar& b) const noexcept { return {
        .i = -b.i
    }; }

    constexpr PointCenter PointCenter::sandwich(const PointCenter& b) const noexcept { return {

    }; }


}